(()=>{document.querySelectorAll("[hf-hidden]").forEach(o=>o instanceof HTMLElement&&(o.style.visibility="hidden")),document.addEventListener("submit",async o=>{try{const t=o.target,e=document.activeElement;if(t.hasAttribute("hf-ignore")||e.hasAttribute("hf-ignore"))return;o.preventDefault();const i=new FormData(t),n=e.formMethod||t.method,r=new URL(e.getAttribute("formAction")&&e.formAction||t.action),f={method:n,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(n==="post")f.body=new URLSearchParams([...i]);else{const c=new URLSearchParams(i).toString();c&&(r.search+=(r.search?"&":"?")+c)}const s=await fetch(r.href,f);if(s.redirected){location.href=s.url;return}const u=s.headers.get("content-type"),l=u.indexOf("application/json")>-1?"json":u.indexOf("html")>-1?"html":"text";if(l&&l.indexOf("application/json")!==-1){let c=JSON.parse(await s.json());document.dispatchEvent(new CustomEvent("received-json",{bubbles:!1,detail:{data:c,form:t,button:e}}))}else{let c=await s.text();d({contentType:l,text:c,form:t})}}catch(t){console.error(t);var a=o?.target;a instanceof HTMLFormElement&&a.submit()}});function d(o){if(o.contentType!=="html")return;const a=document.createElement("template");a.innerHTML=o.text.trim();for(const e of a.content.childNodes){if(!(e instanceof HTMLElement))continue;const i=e.getAttribute("target");let n,r;switch(i?(n=document.querySelector(i),r=e.getAttribute("hf-swap")||"append"):e.id?n=document.getElementById(e.id):n=document.body,n||(n=o.form),r){case"append":n.append(e);break;case"prepend":n.prepend(e);break;case"replace":default:n.replaceWith(e)}}var t=document.querySelector("[autofocus]");t instanceof HTMLElement&&(t.removeAttribute("autofocus"),t.focus())}})();
