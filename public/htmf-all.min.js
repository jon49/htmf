(()=>{document.querySelectorAll("[hf-hidden]").forEach(t=>t instanceof HTMLElement&&(t.style.visibility="hidden")),document.addEventListener("submit",async t=>{try{const o=t.target,e=document.activeElement;if(o.hasAttribute("hf-ignore")||e.hasAttribute("hf-ignore"))return;t.preventDefault();const r=new FormData(o),n=e.formMethod||o.method,a=new URL(e.getAttribute("formAction")&&e.formAction||o.action),d={method:n,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(n==="post")d.body=new URLSearchParams([...r]);else{const s=new URLSearchParams(r).toString();s&&(a.search+=(a.search?"&":"?")+s)}const c=await fetch(a.href,d);if(c.redirected){location.href=c.url;return}const l=c.headers.get("content-type");if(l&&l.indexOf("application/json")!==-1){let s=JSON.parse(await c.json());document.dispatchEvent(new CustomEvent("received-json",{bubbles:!1,detail:{data:s,form:o,button:e}}))}else if(l.indexOf("html")>-1){let s=await c.text();u({text:s,form:o})}else console.error(`Unhandled content type "${l}"`)}catch(o){console.error(o);var i=t?.target;i instanceof HTMLFormElement&&i.submit()}});function u(t){const i=document.createElement("template");i.innerHTML=t.text.trim();for(const e of i.content.childNodes){if(!(e instanceof HTMLElement))continue;const r=e.getAttribute("target");let n,a;switch(r?(n=document.querySelector(r),a=e.getAttribute("hf-swap")||"append"):e.id?n=document.getElementById(e.id):n=document.body,n||(n=t.form),a){case"append":n.append(e);break;case"prepend":n.prepend(e);break;case"replace":default:n.replaceWith(e)}}var o=document.querySelector("[autofocus]");o instanceof HTMLElement&&(o.removeAttribute("autofocus"),o.focus())}const m={};function f(t,i,o={args:[],wait:50,isImmediate:!1,immediateFirst:!1}){m[i]||(m[i]=o);const e=m[i];let r=e.timeoutId;const n=this,a=function(){r=void 0,e.isImmediate||t.apply(n,e.args)},d=(e.isImmediate||e.immediateFirst)&&r===void 0;e.immediateFirst=!1,r!==void 0&&clearTimeout(r),e.timeoutId=setTimeout(a,e.wait),d&&t.apply(n,e.args)}function p(t){var i=t.form;!i||(i.querySelector("button")||i.querySelector("[type='submit']"))?.click()}hf={debounce:f,click:p}})();
