(()=>{self.hf={},hf.version="0.2",document.addEventListener("submit",async e=>{try{const o=e.target,n=document.activeElement;if(o.hasAttribute("hf-ignore")||n.hasAttribute("hf-ignore"))return;e.preventDefault();const a=new FormData(o),r=n.formMethod||o.method,s=new URL(n.hasAttribute("formAction")&&n.formAction||o.action),i={method:r,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(r==="post")i.body=new URLSearchParams([...a]);else for(let u of a.entries())s.searchParams.append(...u);const c=await fetch(s.href,i);if(c.redirected){location.href=c.url;return}const l=c.headers.get("content-type");if(l&&l.indexOf("application/json")>-1){let u=JSON.parse(await c.json());n.dispatchEvent(new CustomEvent("hf:json",{bubbles:!0,detail:{data:u,form:o,button:n}}))}else if(l&&l.indexOf("html")>-1){let u=await c.text();p({text:u,form:o,button:n})}else console.error(`Unhandled content type "${l}"`)}catch(o){console.error(o);var t=e?.target;t instanceof HTMLFormElement&&t.submit()}});function d(e,t){return e.getAttribute(t)}function f(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content}function p({text:e,form:t,button:o}){if(!e)return;let n=d(o,"target")??d(t,"target"),a=d(o,"hf-swap")??d(t,"hf-swap")??"innerHTML",r=(n?document.querySelector(n):t)??t;switch(a){case"innerHTML":r.innerHTML=e;break;case"outerHTML":r.outerHTML=e;break;case"append":r.append(f(e));break;case"prepend":r.prepend(f(e));break;case"replace":r.replaceWith(f(e));break;case"oob":for(let i of f(e).childNodes){if(!(i instanceof HTMLElement))continue;let c=i.id??i.dataset.id,l=document.getElementById(c);if(!l){console.warn(`The target ${c} could not be found for swap.`);continue}l.replaceWith(i)}break;default:console.warn(`Unknown swap type: "${a}".`)}var s=document.querySelector("[autofocus]");s instanceof HTMLElement&&(s.removeAttribute("autofocus"),s.focus())}const m={};function h(e,t,o={args:[],wait:50,isImmediate:!1,immediateFirst:!1}){m[t]||(m[t]=o);const n=m[t];let a=n.timeoutId;const r=this,s=function(){a=void 0,n.isImmediate||e.apply(r,n.args)},i=(n.isImmediate||n.immediateFirst)&&a===void 0;n.immediateFirst=!1,a!==void 0&&clearTimeout(a),n.timeoutId=setTimeout(s,n.wait),i&&e.apply(r,n.args)}function b(e){if(typeof e=="string"){let o=document.querySelector(e);o instanceof HTMLElement&&o.click()}else{var t=e.form;if(!t)return;(t.querySelector("button")||t.querySelector("[type='submit']"))?.click()}}hf={debounce:h,click:b}})();
