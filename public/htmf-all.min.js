(()=>{self.hf={},hf.version="0.4";const h=e=>t=>t.hasAttribute(e),u=new WeakMap;function b(e,t,o){e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:o}))}hf.submit=async e=>{try{const o=e instanceof HTMLFormElement?e:e.target;if(u.get(o))return;u.set(o,!0);const n=document.activeElement;if([o,n].find(h("hf-ignore")))return;e?.preventDefault();const a=new FormData(o),i=n.formMethod||o.method,c=new URL(h("formAction")(n)&&n.formAction||o.action),r={method:i,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(i==="post")r.body=new URLSearchParams([...a]);else for(let l of a.entries())c.searchParams.append(...l);const s=await fetch(c.href,r);if(s.redirected){location.href=s.url;return}const f=s.headers.get("content-type");if(f&&f.indexOf("application/json")>-1){let l=JSON.parse(await s.json());b(n,"hf:json",{data:l,form:o,button:n})}else if(f&&f.indexOf("html")>-1){let l=await s.text();w({text:l,form:o,button:n})}else console.error(`Unhandled content type "${f}"`);let g=s.headers.get("hf-events");if(g){let l=JSON.parse(g);for(let[T,H]of Object.entries(l))b(n,T,H)}u.delete(o)}catch(o){console.error(o);var t=e?.target;t instanceof HTMLFormElement&&t.submit()}},document.addEventListener("submit",hf.submit);function d(e,t){return e.getAttribute(t)}function m(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content}function w({text:e,form:t,button:o}){if(e===void 0)return;let n=d(o,"target")??d(t,"target"),a=d(o,"hf-swap")??d(t,"hf-swap")??"innerHTML",i=(n?document.querySelector(n):t)??t;switch(a){case"innerHTML":i.innerHTML=e;break;case"outerHTML":i.outerHTML=e;break;case"append":i.append(m(e));break;case"prepend":i.prepend(m(e));break;case"oob":for(let r of m(e).childNodes){if(!(r instanceof HTMLElement))continue;let s=r.id??r.dataset.id,f=document.getElementById(s);if(!f){console.warn(`The target ${s} could not be found for swap.`);continue}f.replaceWith(r)}break;default:console.warn(`Unknown swap type: "${a}".`)}var c=document.querySelector("[autofocus]");c instanceof HTMLElement&&(c.removeAttribute("autofocus"),c.focus())}const p={};function v(e,t,o={args:[],wait:50,isImmediate:!1,immediateFirst:!1}){p[t]||(p[t]=o);const n=p[t];let a=n.timeoutId;const i=this,c=function(){a=void 0,n.isImmediate||e.apply(i,n.args)},r=(n.isImmediate||n.immediateFirst)&&a===void 0;n.immediateFirst=!1,a!==void 0&&clearTimeout(a),n.timeoutId=setTimeout(c,n.wait),r&&e.apply(i,n.args)}function L(e){if(typeof e=="string"){let t=document.querySelector(e);t instanceof HTMLElement&&t.click()}}hf={debounce:v,click:L}})();
