(()=>{self.hf={},hf.version="0.5";const u=t=>e=>e.hasAttribute(t),h=new WeakMap;function b(t,e,n){t.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:n}))}document.addEventListener("submit",async t=>{const e=t instanceof HTMLFormElement?t:t.target,n=document.activeElement;if(![e,n].find(u("hf-ignore"))&&(t?.preventDefault(),!h.get(e))){h.set(e,!0);try{const s=new FormData(e),f=n.formMethod||e.method,i=new URL(u("formAction")(n)&&n.formAction||e.action),c={method:f,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(f==="post")c.body=new URLSearchParams([...s]);else for(let r of s.entries())i.searchParams.append(...r);const o=await fetch(i.href,c);if(o.redirected){location.href=o.url;return}const a=o.headers.get("content-type");if(a&&a.indexOf("application/json")>-1){let r=JSON.parse(await o.json());b(n,"hf:json",{data:r,form:e,button:n})}else if(a&&a.indexOf("html")>-1){let r=await o.text();g({text:r,form:e,button:n})}else[204,400].includes(o.status)||console.error(`Unhandled content type "${a}"`);let l=o.headers.get("hf-events");try{if(l){let r=JSON.parse(l);for(let[v,H]of Object.entries(r))b(n,v,H)}}catch(r){console.error(r,l)}}catch(s){console.error(s),e instanceof HTMLFormElement&&e.submit()}finally{h.delete(e)}}});function d(t,e){return t.getAttribute(e)}function m(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}function g({text:t,form:e,button:n}){if(t===void 0)return;w();let s=d(n,"target")??d(e,"target"),f=d(n,"hf-swap")??d(e,"hf-swap")??"innerHTML",i=(s?document.querySelector(s):e)??e;switch(f){case"innerHTML":i.innerHTML=t;break;case"outerHTML":i.outerHTML=t;break;case"append":i.append(m(t));break;case"prepend":i.prepend(m(t));break;case"oob":for(let o of m(t).childNodes){if(!(o instanceof HTMLElement))continue;let a=o.id??o.dataset.id,l=document.getElementById(a);if(!l){console.warn(`The target ${a} could not be found for swap.`);continue}l.replaceWith(o)}break;default:console.warn(`Unknown swap type: "${f}".`)}var c=document.querySelector("[autofocus]");c instanceof HTMLElement?(c.removeAttribute("autofocus"),c.focus()):[e,n].find(u("hf-ignore-scroll"))||y()}let p;function w(){p={y:window.scrollY,height:document.body.scrollHeight}}function y(){if(!p)return;let{y:t,height:e}=p;if(t){let n=t+document.body.scrollHeight-e;n!==t&&window.scrollTo({top:n,behavior:"smooth"})}}})();
