(()=>{self.hf={},hf.version="0.2";const w=e=>t=>t?.hasAttribute(e);let c=document,L=c.querySelector.bind(c);const b=new WeakMap;async function f(e,t,n){e.isConnected||(e=c);let s=e.dispatchEvent(new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n}));if(n?.wait&&await n.wait(),!s)return Promise.reject()}c.addEventListener("hf:swap",async e=>{const{detail:t}=e;v(t)}),c.addEventListener("submit",async e=>{const t=c.activeElement,n=e.target,s=e.submitter,i=s??n;if([n,s].find(w("hf-ignore"))||(e.preventDefault(),b.has(n)))return;b.set(n);const u=s?.formMethod||n.method,a={form:n,submitter:s,method:u,active:t};try{const l=new FormData(n),d=new URL(w("formAction")(s)&&s?.formAction||n.action),h={method:u,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(u==="post")h.body=new URLSearchParams([...l]);else for(let o of l.entries())d.searchParams.append(...o);a.xhr={url:d,options:h},await f(i,"hf:beforeRequest",a);const r=await fetch(d.href,h);if(a.xhr.response=r,await f(i,"hf:afterRequest",a),r.redirected){location.href=r.url;return}if(r.status===204)return;if(r.status===205){let o=r.headers.get("location");o&&(location.href=o);return}const T=r.headers.get("content-type");if(T?.includes("application/json")){let o=JSON.parse(await r.json());await f(i,"hf:json",{...a,data:o})}else if(T?.includes("html")){let o=await r.text();await f(i,"hf:swap",{...a,text:o})}else(r.status<200||r.status>399)&&await f(i,"hf:responseError",a);let y=r.headers.get("hf-events");try{if(y){let o=JSON.parse(y);await Promise.all(Object.entries(o).map(([q,$])=>f(i,q,$)))}}catch(o){console.error(o,y)}}catch(l){console.error(l),n instanceof HTMLFormElement&&n.submit()}finally{b.delete(n),await f(i,"hf:completed",a)}});function p(e,t){return e?.getAttribute(t)}function m(e){const t=c.createElement("template");return t.innerHTML=e.trim(),t.content}function v({text:e,form:t,submitter:n,active:s}){if(e==null)return;E(s);let i=p(n,"hf-target")??p(t,"hf-target"),u=p(n,"hf-swap")??p(t,"hf-swap")??"innerHTML",a=(i?L(i):t)??t;switch(u){case"innerHTML":a.innerHTML=e;break;case"outerHTML":a.outerHTML=e;break;case"append":a.append(m(e));break;case"prepend":a.prepend(m(e));break;case"beforebegin":case"afterbegin":case"beforeend":case"afterend":a.insertAdjacentHTML(u,e);break;case"oob":for(let l of m(e).childNodes){if(!(l instanceof HTMLElement))continue;let d=l.id??l.dataset.id,h=c.getElementById(d);if(!h){console.warn(`The target ${d} could not be found for swap.`);continue}h.replaceWith(l)}break;default:console.warn(`Unknown swap type: "${u}".`)}[t,n].find(w("hf-ignore-scroll"))||M()}let g;function E(e){let t=e?.name,n=e?.id;g={y:k(e),q:n&&`#${n}`||t&&`[name="${t}"]`,height:c.body.scrollHeight}}function M(){if(!g)return;let{y:e,q:t}=g,n=t&&L(t);n&&(H("focus",n),H("select",n),n.scrollTo({top:e,behavior:"smooth"}))}function k(e){return e?.getBoundingClientRect().top}function H(e,t){t&&t[e]&&t[e]()}})();
