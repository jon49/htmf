(()=>{self.hf={},hf.version="0.11";const m=t=>e=>e?.hasAttribute(t),p=new WeakMap;function d(t,e,n){return t.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n}))}document.addEventListener("submit",async t=>{const e=t instanceof HTMLFormElement?t:t.target;let n=document.activeElement;n?.form!==e&&(n=void 0);const i=n??e;if([e,n].find(m("hf-ignore"))||(t?.preventDefault(),p.get(e)))return;p.set(e,!0);const l=n?.formMethod||e.method,a={form:e,button:n,method:l};try{const s=new FormData(e),c=new URL(m("formAction")(n)&&n?.formAction||e.action),f={method:l,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(l==="post")f.body=new URLSearchParams([...s]);else for(let o of s.entries())c.searchParams.append(...o);const r=await fetch(c.href,f);if(r.redirected){location.href=r.url;return}if(r.status===205){let o=r.headers.get("location");d(i,"hf:reset-content",{...a,url:o})&&o&&(location.href=o);return}const u=r.headers.get("content-type");if(u&&u.indexOf("application/json")>-1){let o=JSON.parse(await r.json());d(i,"hf:json",{...a,data:o})}else if(u&&u.indexOf("html")>-1){let o=await r.text();y({...a,text:o})}else[204,400].includes(r.status)||console.error(`Unhandled content type "${u}"`);let w=r.headers.get("hf-events");try{if(w){let o=JSON.parse(w);for(let[L,T]of Object.entries(o))d(i,L,T)}}catch(o){console.error(o,w)}}catch(s){console.error(s),e instanceof HTMLFormElement&&e.submit()}finally{p.delete(e),d(i,"hf:completed",a)}});function h(t,e){return t?.getAttribute(e)}function b(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}function y({text:t,form:e,button:n}){if(t==null)return;v();let i=h(n,"target")??h(e,"target"),l=h(n,"hf-swap")??h(e,"hf-swap")??"innerHTML",a=(i?document.querySelector(i):e)??e;switch(l){case"innerHTML":a.innerHTML=t;break;case"outerHTML":a.outerHTML=t;break;case"append":a.append(b(t));break;case"prepend":a.prepend(b(t));break;case"oob":for(let c of b(t).childNodes){if(!(c instanceof HTMLElement))continue;let f=c.id??c.dataset.id,r=document.getElementById(f);if(!r){console.warn(`The target ${f} could not be found for swap.`);continue}r.replaceWith(c)}break;default:console.warn(`Unknown swap type: "${l}".`)}var s=document.querySelector("[autofocus]");s instanceof HTMLElement?(s.removeAttribute("autofocus"),s.focus()):[e,n].find(m("hf-ignore-scroll"))||H()}let g;function v(){g={y:window.scrollY,height:document.body.scrollHeight}}function H(){if(!g)return;let{y:t,height:e}=g;if(t){let n=t+document.body.scrollHeight-e;n!==t&&window.scrollTo({top:n,behavior:"smooth"})}}})();
