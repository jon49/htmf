(()=>{self.hf={},hf.version="0.5";const p=t=>e=>e.hasAttribute(t),d=new WeakMap;function h(t,e,n){t.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:n}))}document.addEventListener("submit",async t=>{const e=t instanceof HTMLFormElement?t:t.target;if(!d.get(e)){d.set(e,!0);try{const n=document.activeElement;if([e,n].find(p("hf-ignore")))return;t?.preventDefault();const i=new FormData(e),l=n.formMethod||e.method,a=new URL(p("formAction")(n)&&n.formAction||e.action),c={method:l,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(l==="post")c.body=new URLSearchParams([...i]);else for(let s of i.entries())a.searchParams.append(...s);const o=await fetch(a.href,c);if(o.redirected){location.href=o.url;return}const r=o.headers.get("content-type");if(r&&r.indexOf("application/json")>-1){let s=JSON.parse(await o.json());h(n,"hf:json",{data:s,form:e,button:n})}else if(r&&r.indexOf("html")>-1){let s=await o.text();b({text:s,form:e,button:n})}else console.error(`Unhandled content type "${r}"`);let f=o.headers.get("hf-events");if(f){let s=JSON.parse(f);for(let[w,g]of Object.entries(s))h(n,w,g)}}catch(n){console.error(n),e instanceof HTMLFormElement&&e.submit()}finally{d.delete(e)}}});function u(t,e){return t.getAttribute(e)}function m(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}function b({text:t,form:e,button:n}){if(t===void 0)return;let i=u(n,"target")??u(e,"target"),l=u(n,"hf-swap")??u(e,"hf-swap")??"innerHTML",a=(i?document.querySelector(i):e)??e;switch(l){case"innerHTML":a.innerHTML=t;break;case"outerHTML":a.outerHTML=t;break;case"append":a.append(m(t));break;case"prepend":a.prepend(m(t));break;case"oob":for(let o of m(t).childNodes){if(!(o instanceof HTMLElement))continue;let r=o.id??o.dataset.id,f=document.getElementById(r);if(!f){console.warn(`The target ${r} could not be found for swap.`);continue}f.replaceWith(o)}break;default:console.warn(`Unknown swap type: "${l}".`)}var c=document.querySelector("[autofocus]");c instanceof HTMLElement&&(c.removeAttribute("autofocus"),c.focus())}})();
