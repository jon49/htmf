(()=>{self.hf={},hf.version="0.2",document.addEventListener("submit",async e=>{try{const n=e.target,r=document.activeElement;if(n.hasAttribute("hf-ignore")||r.hasAttribute("hf-ignore"))return;e.preventDefault();const u=new FormData(n),o=r.formMethod||n.method,i=new URL(r.hasAttribute("formAction")&&r.formAction||n.action),c={method:o,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(o==="post")c.body=new URLSearchParams([...u]);else for(let l of u.entries())i.searchParams.append(...l);const a=await fetch(i.href,c);if(a.redirected){location.href=a.url;return}const s=a.headers.get("content-type");if(s&&s.indexOf("application/json")>-1){let l=JSON.parse(await a.json());r.dispatchEvent(new CustomEvent("hf:json",{bubbles:!0,detail:{data:l,form:n,button:r}}))}else if(s&&s.indexOf("html")>-1){let l=await a.text();p({text:l,form:n,button:r})}else console.error(`Unhandled content type "${s}"`)}catch(n){console.error(n);var t=e?.target;t instanceof HTMLFormElement&&t.submit()}});function f(e,t){return e.getAttribute(t)}function d(e){const t=document.createElement("template");return t.innerHTML=e.trim(),t.content}function p({text:e,form:t,button:n}){if(!e)return;let r=f(n,"target")??f(t,"target"),u=f(n,"hf-swap")??f(t,"hf-swap")??"innerHTML",o=(r?document.querySelector(r):t)??t;switch(u){case"innerHTML":o.innerHTML=e;break;case"outerHTML":o.outerHTML=e;break;case"append":o.append(d(e));break;case"prepend":o.prepend(d(e));break;case"replace":o.replaceWith(d(e));break;case"oob":for(let c of d(e).childNodes){if(!(c instanceof HTMLElement))continue;let a=c.id??c.dataset.id,s=document.getElementById(a);if(!s){console.warn(`The target ${a} could not be found for swap.`);continue}s.replaceWith(c)}break;default:console.warn(`Unknown swap type: "${u}".`)}var i=document.querySelector("[autofocus]");i instanceof HTMLElement&&(i.removeAttribute("autofocus"),i.focus())}})();
