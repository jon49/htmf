(()=>{self.hf={},hf.version="0.8";const m=t=>e=>e?.hasAttribute(t),p=new WeakMap;function u(t,e,n){return t.dispatchEvent(new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n}))}document.addEventListener("submit",async t=>{const e=t instanceof HTMLFormElement?t:t.target;let n=document.activeElement;n?.form!==e&&(n=void 0);const s=n??e;if([e,n].find(m("hf-ignore"))||(t?.preventDefault(),p.get(e)))return;p.set(e,!0);const l=n?.formMethod||e.method,r={form:e,button:n,method:l};try{const i=new FormData(e),c=new URL(m("formAction")(n)&&n?.formAction||e.action),f={method:l,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(l==="post")f.body=new URLSearchParams([...i]);else for(let a of i.entries())c.searchParams.append(...a);const o=await fetch(c.href,f);if(o.redirected){u(s,"hf:redirected",r)&&(location.href=o.url);return}const d=o.headers.get("content-type");if(d&&d.indexOf("application/json")>-1){let a=JSON.parse(await o.json());u(s,"hf:json",{...r,data:a})}else if(d&&d.indexOf("html")>-1){let a=await o.text();y({...r,text:a})}else[204,400].includes(o.status)||console.error(`Unhandled content type "${d}"`);let w=o.headers.get("hf-events");try{if(w){let a=JSON.parse(w);for(let[L,T]of Object.entries(a))u(s,L,T)}}catch(a){console.error(a,w)}}catch(i){console.error(i),e instanceof HTMLFormElement&&e.submit()}finally{p.delete(e),u(s,"hf:completed",r)}});function h(t,e){return t?.getAttribute(e)}function b(t){const e=document.createElement("template");return e.innerHTML=t.trim(),e.content}function y({text:t,form:e,button:n}){if(t===void 0)return;v();let s=h(n,"target")??h(e,"target"),l=h(n,"hf-swap")??h(e,"hf-swap")??"innerHTML",r=(s?document.querySelector(s):e)??e;switch(l){case"innerHTML":r.innerHTML=t;break;case"outerHTML":r.outerHTML=t;break;case"append":r.append(b(t));break;case"prepend":r.prepend(b(t));break;case"oob":for(let c of b(t).childNodes){if(!(c instanceof HTMLElement))continue;let f=c.id??c.dataset.id,o=document.getElementById(f);if(!o){console.warn(`The target ${f} could not be found for swap.`);continue}o.replaceWith(c)}break;default:console.warn(`Unknown swap type: "${l}".`)}var i=document.querySelector("[autofocus]");i instanceof HTMLElement?(i.removeAttribute("autofocus"),i.focus()):[e,n].find(m("hf-ignore-scroll"))||H()}let g;function v(){g={y:window.scrollY,height:document.body.scrollHeight}}function H(){if(!g)return;let{y:t,height:e}=g;if(t){let n=t+document.body.scrollHeight-e;n!==t&&window.scrollTo({top:n,behavior:"smooth"})}}})();
