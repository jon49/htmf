(()=>{document.querySelectorAll("[hf-hidden]").forEach(t=>t instanceof HTMLElement&&(t.style.visibility="hidden")),document.addEventListener("submit",async t=>{try{const n=t.target,e=document.activeElement;if(n.hasAttribute("hf-ignore")||e.hasAttribute("hf-ignore"))return;t.preventDefault();const r=new FormData(n),o=e.formMethod||n.method,a=new URL(e.getAttribute("formAction")&&e.formAction||n.action),m={method:o,credentials:"same-origin",headers:new Headers({"HF-Request":"true"})};if(o==="post")m.body=new URLSearchParams([...r]);else{const s=new URLSearchParams(r).toString();s&&(a.search+=(a.search?"&":"?")+s)}const c=await fetch(a.href,m);if(c.redirected){location.href=c.url;return}const u=c.headers.get("content-type"),l=u.indexOf("application/json")>-1?"json":u.indexOf("html")>-1?"html":"text";if(l&&l.indexOf("application/json")!==-1){let s=JSON.parse(await c.json());document.dispatchEvent(new CustomEvent("received-json",{bubbles:!1,detail:{data:s,form:n,button:e}}))}else{let s=await c.text();f({contentType:l,text:s,form:n})}}catch(n){console.error(n);var i=t?.target;i instanceof HTMLFormElement&&i.submit()}});function f(t){if(t.contentType!=="html")return;const i=document.createElement("template");i.innerHTML=t.text.trim();for(const e of i.content.childNodes){if(!(e instanceof HTMLElement))continue;const r=e.getAttribute("target");let o,a;switch(r?(o=document.querySelector(r),a=e.getAttribute("hf-swap")||"append"):e.id?o=document.getElementById(e.id):o=document.body,o||(o=t.form),a){case"append":o.append(e);break;case"prepend":o.prepend(e);break;case"replace":default:o.replaceWith(e)}}var n=document.querySelector("[autofocus]");n instanceof HTMLElement&&(n.removeAttribute("autofocus"),n.focus())}const d={};function p(t,i,n={args:[],wait:50,isImmediate:!1,immediateFirst:!1}){d[i]||(d[i]=n);const e=d[i];let r=e.timeoutId;const o=this,a=function(){r=void 0,e.isImmediate||t.apply(o,e.args)},m=(e.isImmediate||e.immediateFirst)&&r===void 0;e.immediateFirst=!1,r!==void 0&&clearTimeout(r),e.timeoutId=setTimeout(a,e.wait),m&&t.apply(o,e.args)}function h(t){var i=t.form;!i||(i.querySelector("button")||i.querySelector("[type='submit']"))?.click()}hf={debounce:p,click:h}})();
